# EDINET 書類取得 API 仕様書

## 3-2 書類取得 API

書類取得 API の仕様について説明します。

### 3-2-1 リクエストについて

書類取得 API に送信するリクエストについて説明します。

#### リクエスト URL

REST 方式にて設計したリクエスト URL です。

```
https://api.edinet-fsa.go.jp/api/{バージョン}/documents/{書類管理番号}?type={必要書類}&Subscription-Key={APIキー}
```

#### HTTP 通信方式

TLS1.2 以上のサポートにて暗号化通信を行います。

> **注意**  
> EDINET API では、クロスドメインの通信を許可しません。  
> ブラウザ上で動作するスクリプト（JavaScript 等）を利用した通信は行えない点に留意してください。

#### HTTP メソッド

GET メソッドを使用してください。

#### エンドポイント

REST 方式にて設計したエンドポイントを提供します。

```
https://api.edinet-fsa.go.jp/api/{バージョン}/documents/{書類管理番号}
```

#### バージョン

エンドポイントに指定するバージョンは「v + 整数」で表記します。（例：v2）  
当仕様書はバージョン 2 を対象としておりますので v2 を指定ください。

#### 書類管理番号

取得したい書類の書類管理番号を指定します（書類管理番号は、書類一覧 API で取得した提出書類一覧に基づきます。ただし、開示対象外の書類は取得できません。）。

#### リクエストパラメータ

書類取得 API は次のパラメータが利用可能です。

| パラメータ名     | 項目名   | 必須 | 設定値                                                | 説明                                         |
| ---------------- | -------- | ---- | ----------------------------------------------------- | -------------------------------------------- |
| type             | 必要書類 | ○    | 1                                                     | 提出本文書及び監査報告書（※1）を取得します。 |
|                  |          |      | 2                                                     | PDF（※2）を取得します。                      |
|                  |          |      | 3                                                     | 代替書面・添付文書を取得します。             |
|                  |          |      | 4                                                     | 英文ファイルを取得します。                   |
|                  |          |      | 5                                                     | CSV（※3）を取得します。                      |
| Subscription-Key | API キー | ○    | 「2-3-2-1 API キーの発行」で画面に表示された API キー | EDINET API の認証に利用します。              |

<凡例>  
○：必須

※1 「提出本文書及び監査報告書」は提出書類本文（外国会社の英文報告本文は除く）に加えて、監査報告書、XBRL ファイルを取得します。XBRL ファイルは、「3-1-2-2 書類一覧 API（提出書類一覧及びメタデータ）の出力データ内容の No35.XBRL 有無フラグが"1"（あり）の場合に取得可能です。

※2 「PDF」は、EDINET の検索結果一覧画面に表示される PDF 表示の文字列リンクをクリックすることにより取得可能な PDF のことであり、その他の PDF は含みません（添付文書中の PDF は、必要書類＝"2"では取得できず、必要書類＝"3"で取得できます。）。

※3 「CSV」は、提出書類の XBRL データを CSV 形式に変換したファイルのことです。「3-1-2-2 書類一覧 API（提出書類一覧及びメタデータ）の出力データ内容の No39.CSV 有無フラグが"1"（あり）の場合に取得可能です。

#### パラメータの指定方法

パラメータは次の方法で指定します。

① 「パラメータ名」と「設定値」を "=" で結合します。  
② 「エンドポイント」と「①で作成したパラメータ文字列」を "?" で結合します。

> **MEMO: 書類取得 API のリクエスト URL（サンプル）**
>
> 書類取得 API にて、書類管理番号が「S1234567」、必要書類が「提出本文書及び監査報告書」を取るリクエストを送信する場合、リクエスト URL は次のような構成となります。
>
> ```
> https://api.edinet-fsa.go.jp/api/v2/documents/S1234567?type=1&Subscription-Key=ZZZ...ZZZ
> ```

### 3-2-2 レスポンスについて

書類取得 API から返却されるレスポンスについて説明します。

#### レスポンスヘッダ

レスポンスに設定されるヘッダ情報は次のとおりです。

| ヘッダ名     | 値                              | 備考                                               |
| ------------ | ------------------------------- | -------------------------------------------------- |
| Content-Type | application/octet-stream        | ZIP 形式のデータの取得に成功した場合の設定値です。 |
|              | application/pdf                 | PDF 形式のデータの取得に成功した場合の設定値です。 |
|              | application/json; charset=utf-8 | データの取得に失敗した場合の設定値です。           |

#### 出力データ内容

書類取得 API から返却される出力データは、指定した書類のバイナリデータとして出力されます。バイナリデータを任意のファイルに書き出すことで、ファイルとして保存することが可能となります。

パラメータ「必要書類」ごとのファイル形式は次のとおりです。

| 必要書類（コード値） | コード名称               | ファイル形式 |
| -------------------- | ------------------------ | ------------ |
| 1                    | 提出本文書及び監査報告書 | ZIP 形式     |
| 2                    | PDF                      | PDF 形式     |
| 3                    | 代替書面・添付文書       | ZIP 形式     |
| 4                    | 英文ファイル             | ZIP 形式     |
| 5                    | CSV                      | ZIP 形式     |

> **注意: XBRL ファイルについて**
>
> 提出書類がインライン XBRL 形式の場合、書類取得 API で必要書類のコード値に 1 を指定することで XBRL データを取得できますが、次の点は EDINET の検索結果一覧画面から取得できる XBRL ダウンロードと異なります。
>
> - ZIP 解凍時のフォルダ構成は、「圧縮ファイルの構成」の構成図のとおりになります。
> - 「XbrlSearchDlInfo.csv」は含まれません。
>
> なお、「XbrlSearchDlInfo.csv」に含まれる情報は、書類一覧 API で取得する提出書類一覧に含まれます。また、XBRL インスタンス形式のファイルが含まれる点は、EDINET の検索結果一覧画面から取得できる XBRL ダウンロードと同様です。

> **注意: 提出書類内容照会画面（書類の詳細を閲覧する画面）のヘッダと日次について**
>
> EDINET の提出書類内容照会画面（書類の詳細を閲覧する画面）で提供される、ヘッダ部と日次部分は書類取得 API で提供される資料に含まれません。なお、ヘッダ部の情報は、書類一覧 API で取得する提出書類一覧に含まれます。

#### 圧縮ファイルの構成

書類取得 API で取得できる各圧縮ファイルの構成については次のとおりです。

**必要書類（コード値）1: ZIP ファイル**

```
ZIPファイル
├── PublicDoc/                # 提出本文書
│   └── サブフォルダ         # インライン XBRL を用いる提出書類以外の場合の提出本文書の格納フォルダです。
├── AuditDoc/                 # 監査報告書
│   └── サブフォルダ         # インライン XBRL を用いる提出書類以外の場合の監査報告書の格納フォルダです。
├── XBRL/
│   ├── PublicDoc/           # 提出本文書（XBRL）
│   │   └── サブフォルダ     # 提出本文書（XBRL 又はインライン XBRL）、マニフェストファイル及びタクソノミファイルの格納フォルダです。
│   ├── AuditDoc/            # 監査報告書（XBRL）
│   │   └── サブフォルダ     # 監査報告書（インライン XBRL）、マニフェストファイル及びタクソノミファイルの格納フォルダです。
│   └── EnglishDoc/          # 英文ファイル
│       └── サブフォルダ     # 英文ファイルの格納フォルダです。
```

**必要書類（コード値）2: PDF 形式**

PDF 形式で取得されます。

**必要書類（コード値）3: ZIP ファイル**

```
ZIPファイル
└── AttachDoc/               # 代替書面・添付文書
    └── サブフォルダ         # 代替書面・添付文書の格納フォルダです。
```

**必要書類（コード値）4: ZIP ファイル**

```
ZIPファイル
└── EnglishDoc/              # 英文ファイル
    └── サブフォルダ         # 英文ファイルの格納フォルダです。
```

**必要書類（コード値）5: ZIP ファイル**

```
ZIPファイル
└── XBRL_TO_CSV/            # 提出本文書（CSV）及び監査報告書（CSV）
                            # 提出本文書及び監査報告書の XBRL ファイルを、CSV 形式に変換したファイルの格納フォルダです。
```

※付随ファイルとは、画像及び型フォルダに保存された HTML ファイルからリンクされた HTML ファイルであり、提出時のフォルダ構成で提供されます。

#### CSV ファイルのレイアウト

圧縮ファイルに格納される CSV ファイルの内容については、『開示府令『書類関覧操作ガイド』1 章 EDINET の基本操作 3 共通操作 3-2-1 EDINET からダウンロードできるファイル』を参照してください。

### 3-3 ステータスコード

EDINET API のレスポンスに設定されるステータスコードについて説明します。

EDINET API へのアクセスは、提供される API のエンドポイントの共通部分である「https://api.edinet-fsa.go.jp/api/{バージョン}」から始まるアクセスを行った場合に、処理を行います。それ以外のアクセス対象や、EDINET 自体がメンテナンス等を行っている場合は、ブラウザからのアクセスと同様にエラー画面や Sorry 画面を返却します。エラー画面、Sorry 画面又はそもそも通信結果が返ってこないような場合には、EDINET のトップページ又は金融庁ウェブサイトの各種情報検索サービスにてメンテナンス等の情報を確認してください。また、通信経路あるいは EDINET API を利用するプログラムの設定等を再確認してください。

EDINET API へのアクセスを行い、パラメータの誤り等によりエラーとなった場合、レスポンスの出力データは、エラー情報を示す JSON 形式の文字列となります。このとき、レスポンスの HTTP ステータスは"200"となります。
エラー情報を示す JSON 形式の文字列には「ステータス」及び「メッセージ」が出力されます。出力される値の一覧は次のとおりです。

| ステータス | メッセージ                                                                                                  | 説明                                                           | 対処方法                                                                                                                                                                   |
| ---------- | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 200        | OK                                                                                                          | リクエスト成功時（書類一覧 API の成功時に設定される）          | ー                                                                                                                                                                         |
| 400        | Bad Request                                                                                                 | リクエストデータに問題あり（パラメータの内容や文字コード誤り） | リクエスト内容が誤っています。リクエストの内容（エンドポイント、パラメータの形式等）を見直してください。                                                                   |
| 401        | Access denied due to invalid subscription key. Make sure to provide a valid key for an active subscription. | API キーが無効                                                 | API キーが誤っている、リクエストパラメータに API キーが指定されていません。再度 API キー発行画面に表示されている API キーを確認のうえ、正しい API キーを指定してください。 |
| 404        | Not Found                                                                                                   | リソースが存在しない                                           | データが取得できません。リクエストパラメータの指定方法及び設定値を見直してください。                                                                                       |
| 500        | Internal Server Error                                                                                       | サーバ側での処理中にエラー                                     | EDINET のトップページ又は金融庁ウェブサイトの各種情報検索サービスにてメンテナンス等の情報を確認してください。                                                              |

> **注意: 書類取得 API を利用する際のリクエスト結果の判定について**
>
> 書類取得 API は、リクエストの成功/エラーで、レスポンスに出力されるデータの形式がそれぞれ異なります。しかし、レスポンス上は HTTP ステータスが"200"、から出力データ内容に何らかのデータが出力されるため、これらの情報だけではエラーを検知することは困難です。
>
> 従って書類取得 API では、リクエストの成功/エラーに応じたレスポンスヘッダの"Content-Type"を設定しています。この値を判定することで、レスポンスの出力データ内容がどの形式なのかを機械的に判定することが可能となります。
>
> "Content-Type"の設定値については『開示3-2-2 レスポンスについて レスポンスヘッダ』を参照してください。

> **MEMO: エラー情報として出力されるデータの内容（サンプル）**
>
> リクエストがエラーとなった場合に出力されるデータ内容は次のような構成となります。
>
> A) リクエスト結果が "400"（Bad Request）、"404"（Not Found）、"500"（Internal Server Error）の場合  
> （サンプル）リクエスト結果が "404"（Not Found）であった場合の出力データ内容
>
> ```json
> {
>   "metadata": {
>     "title": "提出された書類を把握するための API",
>     "status": "404",
>     "message": "Not Found"
>   }
> }
> ```
>
> ※ 書類一覧 API（メタデータ）のうち、「パラメータ」、「結果セット」及び「書類一覧更新日時」の項目を持たないデータ構成となります。
>
> B) リクエスト結果が "401"（Access denied due to invalid subscription key）であった場合の出力データ内容
>
> ```json
> {
>   "StatusCode": 401,
>   "message": "Access denied due to invalid subscription key. Make sure to provide a valid key for an active subscription."
> }
> ```
